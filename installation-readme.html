<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\markdown/installation-readme.md at 2021-06-09
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20210609" />
    <meta http-equiv="Content-Language" content="fr" />
    <title>TumoroteK &#x2013; Installation de TumoroteK version 2.2.3</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
<link rel="icon" href="images/favicon.ico">
            <script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js" integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy" crossorigin="anonymous"></script>
            <script>
                window.onload = function() {
                    document.querySelectorAll('[title="GitHub"]')[0].href = "https://github.com/TumoroteK/TumoroteK";
                    document.querySelectorAll('[title="Liste des versions"]')[0].href = "https://github.com/TumoroteK/TumoroteK/releases";
                    document.querySelectorAll('[title="Dossier d\'installation"]')[0].href = "https://github.com/TumoroteK/TumoroteK/releases/download/v2.2.3/tumorotek-install-2.2.3.zip";
                };
            </script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="https://tumorotek.github.io/TumoroteK" id="bannerLeft"><img src="images/logo_tumo.png"  alt="TumoroteK"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="./" title="Liste des versions">Liste des versions</a><span class="divider">/</span></li>
    <li class="active ">Installation de TumoroteK version 2.2.3</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Dernière publication: 2021-06-09</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 2.2.3</li>
      <li class="pull-right"><a href="./" title="GitHub"><img class="imageLink" src="images/GitHub-Mark-32px.png" alt="" width="14px"/>GitHub</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">TumoroteK</li>
    <li><a href="note-version.html" title="Notes de version"><span class="none"></span>Notes de version</a></li>
    <li><a href="TumoroteK-Manuel.pdf" title="Manuel d'utilisation"><span class="none"></span>Manuel d'utilisation</a></li>
      <li class="nav-header">Procédures</li>
    <li class="active"><a href="#"><span class="none"></span>Installation</a></li>
    <li><a href="installation-readme-old.html" title="Ancienne installation"><span class="none"></span>Ancienne installation</a></li>
    <li><a href="mise-a-jour-readme.html" title="Mise à jour"><span class="none"></span>Mise à jour</a></li>
      <li class="nav-header">Ressources</li>
    <li><a href="" title="Dossier d'installation"><span class="none"></span>Dossier d'installation</a></li>
    <li><a href="TumoroteK-DossierExploitation.pdf" title="Dossier d'exploitation"><span class="none"></span>Dossier d'exploitation</a></li>
    <li><a href="TumoroteK-InterfaçagesSGL.pdf" title="Dossier sur les interfaçages avec des SGL"><span class="none"></span>Dossier sur les interfaçages avec des SGL</a></li>
    <li><a href="Installation_parametrage_HCL_V2.pdf" title="Note d'installation et de paramétrage VisionMate©"><span class="none"></span>Note d'installation et de paramétrage VisionMate©</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://www.aphp.fr" title="AP-HP" class="builtBy"><img class="builtBy"  alt="AP-HP" src="images/aphp-new.png"    /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<div class="section">
<div class="section">
<h4><a name="Installation_de_TumoroteK_version_2.2.3"></a>Installation de TumoroteK version 2.2.3</h4>
<p><img src="https://img.shields.io/badge/TumoroteK-2.2.3-brightgreen.svg" alt="TumoroteK version 2.2.3" title="TumoroteK version 2.2.3" /> <img src="https://img.shields.io/badge/Java-&gt;=_8-blue.svg" alt="Java version 8" title="Java version 8" /> <img src="https://img.shields.io/badge/Apache_Tomcat-&gt;=_7-yellow.svg" alt="Apache Tomcat version 7" title="Apache Tomcat version 7" /></p>
<div class="section">
<h5><a name="Voir_le_document_d.E2.80.99exploitation_d.C3.A9taillant_l.E2.80.99architecture_de_l.E2.80.99environnement_applicatif"></a>Voir le document d&#x2019;exploitation d&#xe9;taillant l&#x2019;architecture de l&#x2019;environnement applicatif</h5><hr /></div>
<div class="section">
<h5><a name="Installation_de_l.E2.80.99environnement_applicatif_:"></a>Installation de l&#x2019;environnement applicatif :</h5>
<ul>

<li>MySQL ou MariaDB</li>
</ul>
<blockquote>

<p>Param&#xe9;trage &#xe9;ventuel : modifier le path du dossier contenant les donn&#xe9;es dans la variable <tt>datadir</tt> du fichier <i><tt>my.cnf</tt></i>.</p>
</blockquote>
<ul>

<li>Java 8 minimum</li>
<li>Apache Tomcat 7 minimum</li>
<li>Param&#xe9;trage obligatoire : ajouter les variables de d&#xe9;marrage Java <tt>-Duser.language=en -XX:MaxPermSize=256m</tt></li>
<li>Param&#xe9;trage conseill&#xe9; : ajouter les variables de d&#xe9;marrage Java <tt>-Xms512m -Xmx1024m</tt><br />
(ces param&#xe9;trages sont renseign&#xe9;s directement sous Windows dans l&#x2019;utilitaire <tt>configureTomcat</tt>, sous Unix, dans la variable <tt>CATALINA_OPTS</tt>, par l&#x2019;interm&#xe9;diaire du script de d&#xe9;marrage <tt>/etc/init.d/tomcat.sh</tt> par exemple)</li>
</ul><hr /></div>
<div class="section">
<h5><a name="A._T.C3.A9l.C3.A9charger_puis_d.C3.A9zipper_le_package_d.E2.80.99installation_:"></a>A. T&#xe9;l&#xe9;charger puis d&#xe9;zipper le package d&#x2019;installation :</h5>
<p><a class="externalLink" href="https://github.com/TumoroteK/TumoroteK/releases/download/v2.2.3/tumorotek-install-2.2.3.zip">Dossier d&#x2019;installation</a></p></div>
<div class="section">
<h5><a name="B._Recommand.C3.A9_:_cr.C3.A9ation_d.E2.80.99un_utilisateur_de_base_de_donn.C3.A9es_d.C3.A9di.C3.A9_.C3.A0_l.E2.80.99application_TumoroteK_.2B_autorisations_sur_les_trois_bases_de_donn.C3.A9es"></a>B. Recommand&#xe9; : cr&#xe9;ation d&#x2019;un utilisateur de base de donn&#xe9;es d&#xe9;di&#xe9; &#xe0; l&#x2019;application TumoroteK + autorisations sur les trois bases de donn&#xe9;es</h5>

<div>
<div>
<pre class="source">mysql&gt; create user tumo@'localhost' identified by 'tumo';
mysql&gt; GRANT ALL PRIVILEGES ON tumorotek_codes.* TO tumo@'localhost';
mysql&gt; GRANT ALL PRIVILEGES ON tumorotek_interfacages.* TO tumo@'localhost';
mysql&gt; GRANT ALL PRIVILEGES ON tumorotek.* TO tumo@'localhost';
</pre></div></div>

<blockquote>

<p>Cet exemple de cr&#xe9;ation de compte d&#xe9;di&#xe9; se base sur le principe d&#x2019;une connexion uniquement en <tt>localhost</tt>, MySQL et Apache Tomcat &#xe9;tant donc install&#xe9;s sur la m&#xea;me machine, adaptez ces lignes et le niveau de s&#xe9;curit&#xe9; en cas de l&#x2019;utilisation d&#x2019;un serveur de base de donn&#xe9;es d&#xe9;di&#xe9;</p>
</blockquote></div>
<div class="section">
<h5><a name="C._Pr.C3.A9paration_au_d.C3.A9ploiement_de_l.E2.80.99application_TumoroteK"></a>C. Pr&#xe9;paration au d&#xe9;ploiement de l&#x2019;application TumoroteK</h5>
<ol style="list-style-type: decimal">

<li>Arr&#xea;ter le service Apache Tomcat</li>
<li>D&#xe9;placer le contenu du dossier <tt>localhost</tt> dans le dossier <tt>&lt;PATH_TOMCAT&gt;/conf/Catalina/localhost</tt>
<blockquote>

<p><span class="fas fa-exclamation-triangle" aria-hidden="true"></span> Pour que l&#x2019;application fonctionne correctement, le fichier <tt>tumorotek.properties</tt> ne doit pas &#xea;tre d&#xe9;plac&#xe9; ou renomm&#xe9;.</p>
</blockquote>
</li>
<li>Modification du fichier de param&#xe9;trage de l&#x2019;application <tt>&lt;PATH_TOMCAT&gt;/conf/Catalina/localhost/tumorotek.properties</tt> :
<ol style="list-style-type: decimal">

<li>

<p>Param&#xe8;tres de connexion JDBC &#xe0; la base de PRODUCTION <b>tumorotek</b> :</p>

<div>
<div>
<pre class="source">db.url = jdbc:mysql://localhost:3306/tumorotek?createDatabaseIfNotExist=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true&amp;serverTimezone=Europe/Paris
db.user = tumo
db.password = tumo
</pre></div></div>
</li>
<li>

<p>Param&#xe8;tres de connexion JDBC &#xe0; la base de codifications m&#xe9;dicales <b>tumorotek_codes</b></p>

<div>
<div>
<pre class="source">db.codes.url = jdbc:mysql://localhost:3306/tumorotek_codes?createDatabaseIfNotExist=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Europe/Paris
db.codes.user = tumo
db.codes.password = tumo
</pre></div></div>
</li>
<li>

<p>Param&#xe8;tres de connexion JDBC &#xe0; la base interfaces <b>tumorotek_interfacages</b></p>

<div>
<div>
<pre class="source">db.interfacages.url = jdbc:mysql://localhost:3306/tumorotek_interfacages?createDatabaseIfNotExist=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Europe/Paris
db.interfacages.user = tumo
db.interfacages.password = tumo
</pre></div></div>
</li>
<li>

<p>Param&#xe8;trage du dossier racine des fichiers associ&#xe9;s aux donn&#xe9;es</p>
<blockquote>

<p>Il est recommand&#xe9; pour faciliter les sauvegardes de placer ce dossier dans le m&#xea;me lecteur/dossier que le <tt>datadir</tt> mysql</p>
</blockquote>

<div>
<div>
<pre class="source"># exemple : tk.filesystem = D:/data/TK
tk.filesystem = &lt;RACINE_FILESYSTEM&gt;
</pre></div></div>
</li>
<li>

<p>Emplacements des fichiers de configuration fonctionnelle de TumoroteK :</p>
<ul>

<li>

<p>Racine des fichiers de configuration de l&#x2019;application :</p>

<div>
<div>
<pre class="source">tk.conf.dir = &lt;PATH_ABSOLU_TOMCAT&gt;/conf/Catalina/localhost/
</pre></div></div>
</li>
<li>

<p>Configuration connexion directe serveur identit&#xe9;s :</p>

<div>
<div>
<pre class="source">tk.sip.system = &lt;PATH_ABSOLU_TOMCAT&gt;/conf/Catalina/localhost/sip/
</pre></div></div>
</li>
<li>

<p>API imprimante modul-bio :</p>

<div>
<div>
<pre class="source">tk.mbio.system = &lt;PATH_ABSOLU_TOMCAT&gt;/conf/Catalina/localhost/mbio/
</pre></div></div>
</li>
<li>

<p>Configuration interfacages TK :</p>

<div>
<div>
<pre class="source">camel.conf.dir = &lt;PATH_ABSOLU_TOMCAT&gt;/conf/Catalina/localhost/camel/
</pre></div></div>
</li>
</ul>
</li>
<li>

<p>LDAP / ActiveDirectory</p>
<p>L&#x2019;activation de l&#x2019;authentification n&#xe9;cessite de remplacer la ligne du fichier <tt>&lt;PATH_TOMCAT&gt;/conf/Catalina/localhost/tumorotek.properties</tt> suivante</p>

<div>
<div>
<pre class="source">ldap.authentication = false
</pre></div></div>

<p>par</p>

<div>
<div>
<pre class="source">ldap.authentication = true
</pre></div></div>

<p>et d&#x2019;indiquer les param&#xe8;tres de connexion au LDAP dans les lignes suivantes de ce m&#xea;me fichier :</p>

<div>
<div>
<pre class="source">activedirectory.url = &lt;URL_LDAP&gt; (exemple : activedirectory.url = ldap://127.0.0.1:389/dc=sls,dc=aphp,dc=fr)
ldap.userdn = &lt;USER_LDAP&gt;
ldap.password = &lt;MDP_LDAP&gt;
</pre></div></div>
</li>
</ol>
</li>
<li>

<p>Niveaux de logs Log4j</p>
<p>Se r&#xe9;f&#xe9;rer &#xe0; la documentation Log4j pour l&#x2019;&#xe9;dition du fichier <tt>&lt;TOMCAT_PATH&gt;/webapps/tumorotek##2.2.3/WEB-INF/classes/log4j.properties</tt></p>
</li>
<li>

<p>D&#xe9;placer la web archive <tt>tumorotek##2.2.3.war</tt> dans le dossier <tt>&lt;PATH_TOMCAT&gt;/webapps</tt></p>
</li>
<li>D&#xe9;marrer le service Apache Tomcat
<blockquote>

<p>L&#x2019;application TumoroteK va cr&#xe9;er et initialiser les bases de donn&#xe9;es (tumorotek, tumorotek_codes et tumorotek_interfacages) automatiquement.</p>
</blockquote>
</li>
<li>V&#xe9;rifier le bon d&#xe9;ploiement de l&#x2019;application <tt>tumorotek</tt> dans l&#x2019;interface Manager du Tomcat <tt>http://&lt;SERVEUR&gt;:8080/manager/html</tt></li>
</ol><hr /></div>
<div class="section">
<h5><a name="D._Connexion_Super_Administrateur_TK"></a>D. Connexion Super Administrateur TK</h5>
<ul>

<li><b>URL d&#x2019;acc&#xe8;s</b> : <a class="externalLink" href="http://localhost:8080/tumorotek">http://localhost:8080/tumorotek</a></li>
<li><b>Utilisateur</b> : ADMIN_TUMO</li>
<li><b>Mot de passe par d&#xe9;faut</b> <span class="fas fa-exclamation-triangle" aria-hidden="true"></span> A modifier : ADMIN_TUMO</li>
</ul><hr /></div>
<div class="section">
<h5><a name="E._Premiers_param.C3.A9trages_applicatifs_.28consulter_le_manuel_utilisateur.29_:"></a>E. Premiers param&#xe9;trages applicatifs (consulter <a href="TumoroteK-Manuel.pdf">le manuel utilisateur</a>) :</h5>
<ul>

<li>Onglet <b>Administration</b> &gt; <b>Collaborations</b> : cr&#xe9;er l&#x2019;environnement m&#xe9;dical (H&#xf4;pital, Service, Collaborateurs) responsable de la biobanque</li>
<li>Onglet <b>Administration</b> &gt; <b>Comptes</b> : les comptes des utilisateurs du personnel de la biobanque</li>
</ul>
<blockquote>

<p>Il est recommand&#xe9; de confier &#xe0; un des utilisateurs les droits d&#x2019;Administration de la Plateforme dans l&#x2019;onglet <b>Administration</b> &gt; <b>Plateforme</b> afin que cet utilisateur deviennent l&#x2019;utilisateur &#x2018;r&#xe9;f&#xe9;rent&#x2019; pour la biobanque.<br />
Cet utilisateur pourra alors compl&#xe9;ter la configuration selon l&#x2019;activit&#xe9; sp&#xe9;cifique de la biobanque (collections, th&#xe9;saurus, conteneurs de stockage, annotations, autres comptes, profils, mod&#xe8;les d&#x2019;impressions etc&#x2026;)</p>
</blockquote>
<ul>

<li>Onglet <b>Administration</b> &gt; <b>Collection</b> : cr&#xe9;er &#xe9;ventuellement une premi&#xe8;re collection de travail en attribuant des profils sur la collection aux utilisateurs non administrateurs de plateforme.</li>
</ul></div></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2021.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
