name: Build with Oracle JDBC Driver

on:
  push:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      # Set up Java
      - name: Set up JDK 8
        uses: actions/setup-java@v2
        with:
          java-version: '8'
          distribution: 'temurin'

      # Use Maven Wrapper
      - name: Set up Maven Wrapper
        run: ./mvnw.cmd

      # Print contents of repository directory for debugging
      - name: Debug - List contents of repository
        run: dir %USERPROFILE%\.m2\repository /s

      # Update Maven dependencies using Maven Wrapper
      - name: Install Dependencies and Build
        run: |
          .\mvnw.cmd clean install -DskipTests
        env:
          MAVEN_OPTS: -Dmaven.repo.local=%USERPROFILE%\.m2\repository

      # Additional debugging steps
      - name: Debug - Print Maven version
        run: .\mvnw.cmd --version

      - name: Debug - Print Java version
        run: java -version

      - name: Debug - Print environment variables
        run: echo $env:MAVEN_OPTS

      - name: Debug - Print directory contents
        run: dir /s
